# 要求仕様書

以下のようなコマンドを実行するとランダムで計算問題が生成される。
基本はコマンド実行すると以下のような出力が得られる。  
何かオプションをつけると、pdf等で成形したファイルを出力する。 
コマンドのフォーマットはpythonのformatライクとしたい。

```
$ python math_wb.py '{:1} + {:1} = {:1}'
1 + 1 = 
1 + 2 =
3 + 4 =
  ・
  ・
  ・
```

## ファイル構成案
* 計算問題を出力するファイル 足し算・引き算・掛け算等で分ける？  
それだと、'%d + %d * %d = %d'等に対応するの難しい？

* 入力フォーマットを解析し、各クラスへ計算を頼むファイル

* 計算問題に対して回答を出力するファイル。  
こちらは現状箇条書きレベルで問題なし

* 出力された計算問題をpdfやスプレッドシート等に成形して出力するファイル。  
例えばA4用紙2列に計算問題を出力する。  
```
A4用紙のイメージ
2列にして表示したい
| 1 + 1 =  | 5 + 5 = | 
| 2 + 2 =  | 6 + 6 = |
| 3 + 3 =  | 7 + 7 = |
| 4 + 4 =  | 8 + 8 = |
```

## フォーマット例

```
python calc_quiz.py randint(1,9)+randint(1,9)=ans(1,9) #一桁の足し算
python calc_quiz.py randint(1,9)-randint(1,9)=ans(1,9) #一桁の引き算
python calc_quiz.py randint(1,9)[+-/*]randint(1,9)[+-/*]randint(1,9)=ans(1,999,include='()') #三桁の四則演算、括弧を含む
python calc_quiz.py randint(1,9)*randint(1,9)=ans(1,81) #掛け算
python calc_quiz.py randint(1,81)/randint(1,81)=ans(1,81,remainder=0) #割り算　答えに余り禁止
python calc_quiz.py randint(1,81)/randint(1,81)=ans(1,81) #割り算　答えに余りあり

```

演算子も正規表現のように表現できたら便利かも  
例 : [+-*/] -> 足し算、引き算、掛け算、割り算の何れかの演算子を使う。  
random.choice('+-*/')で実現可能  
random.choiceまでコマンドライン引数に組み込むと冗長になりそう。
数式の計算順序を決める括弧も乱数で制御したいが入力が複雑になりそう。

```
python calc_quiz.py randint(1,9)[+-*/]randint(1,9)=ans(1,9)
python calc_quiz.py randint(1,9)+randint(1,9)+randint(1,9)=ans(1,99)
```

4+3*2  
(4+3)*2  
4+(3*2)  
1+2+3*4  
(1+2)+3*4  
(1+2+3)*4  

-> 式によっては計算途中でマイナスの値を出さないようにしないといけない。  
コマンドライン方式だと限界かも。

3桁の足し算なら以下のように表現できれば実現できそう
ans(2,9,+)-randint(1,9)=ans(1,9)

fomula(2,9,+) -> 答えが2〰9になる2項の足し算
fomula(3,9,+,num=3) ->答えが3〰9になる3つの数字の足し算
fomula(3,9,+-,num=3) ->答えが3〰9になる3つの数字の足し算・引き算 括弧もランダムでつける
fomula(1,9,-)+randint(1,9)>0

途中で負の値を出力するのを禁止するオプションを導入する。
pythonで計算結果の途中の値を出すようなものがあれば。
NG : 1-3+10 -> 最終的に答えは正の値だが、途中の計算で負の値になるので、こういった式を検出したい。
括弧を含まなければ、以下の方法で対応可能
1. 1個目の乱数生成
2. 2個目の乱数と演算子の生成
3. 1.と2.の演算結果の判定　負であれば終了、正であれば3個目の乱数と演算子の生成


括弧を含んだ場合、5-(6-4)のような式をどう評価するか。
1. 1個目と2個目の乱数と演算子の生成
2. 括弧のフラグ出て、1.の結果が負の場合、2個目と3個目の式に括弧を入れる。


